<template>
    <lightning-card title="View Users with Permission Sets" icon-name="custom:custom103">

        <p class="slds-p-horizontal_small">
            Require user input to avoid frequent long queries on orgs with many users and permission sets.
        </p>
        <div class="slds-m-around_medium">
            <p class="slds-m-bottom_small">
                <lightning-button label="View Permissions" onclick={handleLoad}></lightning-button>
            </p>
            <template if:true={psalist}>
                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                            <thead>
                              <tr class="slds-line-height_reset">
                                <th class="slds-text-title_caps" scope="col">
                                  <div class="slds-truncate" title="User Name">User Name</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                  <div class="slds-truncate" title="First Name">First Name</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                  <div class="slds-truncate" title="Last Name">Last Name</div>
                                </th>
                                <th class="slds-text-title_caps" scope="col">
                                  <div class="slds-truncate" title="Perm Set Name">Perm Set Name</div>
                                </th>      
                                <th class="slds-text-title_caps" scope="col">
                                  <div class="slds-truncate" title="Profile">Profile</div>
                                </th>
                              </tr>
                            </thead>
                    <tbody>
                    
                        <template for:each={psalist} for:item="psa">
                            <tr class="slds-hint-parent" key={psa.Id}>
                                <td data-label="User Name">
                                    <div class="slds-truncate" title="Username">{psa.Assignee.Username}</div>
                                </td>   
                                <td data-label="First Name">
                                    <div class="slds-truncate" title="Firstname">{psa.Assignee.FirstName}</div>
                                </td>   
                                <td data-label="Last Name">
                                    <div class="slds-truncate" title="Lastname">{psa.Assignee.LastName}</div>
                                </td>   
                                <td data-label="PermSet Name">
                                    <div class="slds-truncate" title="Permsetname">{psa.PermissionSet.Name}</div>
                                </td>   
                                <td data-label="PermSet Name">
                                    <div class="slds-truncate" title="Profile">{psa.PermissionSet.Profile.Name}</div>
                                </td>                       
                            </tr>   
                        </template>
                        
                    </tbody>
                </table>
            </template>
            <template if:true={error}>
                <c-error-panel errors={error}></c-error-panel>
            </template>    
        </div>
    </lightning-card>
    
</template>