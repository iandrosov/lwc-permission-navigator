<template>
    <lightning-card title="View Users with Permission Sets" icon-name="custom:custom87">

        <p class="slds-p-horizontal_small">
            Type name of permission set to get list of assigned users.
        </p>
        <div class="slds-m-around_medium">
            <lightning-layout vertical-align="end" class="slds-m-bottom_small">
                <lightning-layout-item flexibility="grow">
                    <lightning-input type="search" onchange={handleKeyChange} label="Search" value={permsetKey}></lightning-input>
                </lightning-layout-item>
                <lightning-layout-item class="slds-p-left_xx-small">
                    <lightning-button label="Search" onclick={handleSearch}></lightning-button>
                </lightning-layout-item>
            </lightning-layout>

            <template if:true={psalist}>
                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                <thead>
                                  <tr class="slds-line-height_reset">
                                    <th class="slds-text-title_caps" scope="col">
                                      <div class="slds-truncate" title="User Name">User Name</div>
                                    </th>
                                    <th class="slds-text-title_caps" scope="col">
                                      <div class="slds-truncate" title="First Name">First Name</div>
                                    </th>
                                    <th class="slds-text-title_caps" scope="col">
                                      <div class="slds-truncate" title="Last Name">Last Name</div>
                                    </th>
                                  </tr>
                                </thead>
                        <tbody>
                        
                            <template for:each={psalist} for:item="psa">
                                <tr class="slds-hint-parent" key={psa.Id}>
                                    <td data-label="User Name">
                                        <div class="slds-truncate" title="Username">{psa.Assignee.Username}</div>
                                    </td>   
                                    <td data-label="First Name">
                                        <div class="slds-truncate" title="Firstname">{psa.Assignee.FirstName}</div>
                                    </td>   
                                    <td data-label="Last Name">
                                        <div class="slds-truncate" title="Lastname">{psa.Assignee.LastName}</div>
                                    </td>   
                                </tr>   
                            </template>
                            
                        </tbody>
                    </table>
                </template>
                <template if:true={error}>
                    <c-error-panel errors={error}></c-error-panel>
                </template>    
    
        </div>
    </lightning-card>                
</template>